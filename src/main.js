import { Markup, session, Telegraf } from "telegraf";
import { message } from "telegraf/filters";
import config from "config";
import { MESSAGES } from "./constants.js";
import { createInitialSession } from "./sessionManager.js";
import { processTextMessage } from "./chatHandler.js";
import { formatForTelegramBasicMessages } from "./utils.js";

const bot = new Telegraf(config.get("TELEGRAM_TOKEN"));
bot.use(session());

// Ð“Ð»Ð°Ð²Ð½Ð¾Ðµ Ð¼ÐµÐ½ÑŽ Ñ Ð´Ð²ÑƒÐ¼Ñ ÐºÐ½Ð¾Ð¿ÐºÐ°Ð¼Ð¸ Ð¿Ð¾ÑÐ»Ðµ Ð½Ð°Ð¶Ð°Ñ‚Ð¸Ñ "Ð¡Ñ‚Ð°Ñ€Ñ‚"
const mainMenuKeyboard = Markup.keyboard([["FAQ", "Ð§Ð°Ñ‚ Ñ Ð¢Ð°Ð¹ÑÐ¾Ð½Ð¾Ð¼"]])
  .resize()
  .oneTime();

// ÐšÐ»Ð°Ð²Ð¸Ð°Ñ‚ÑƒÑ€Ð° Ð´Ð»Ñ FAQ Ñ Ð½ÐµÑÐºÐ¾Ð»ÑŒÐºÐ¸Ð¼Ð¸ Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ°Ð¼Ð¸
const faqMenuKeyboard = Markup.keyboard([
  [
    "Ð§Ñ‚Ð¾ Ñ‚Ð°ÐºÐ¾Ðµ Ð”ÐœÐ¢ Ð¸ ÑÐºÐ¾ÑÐ¸ÑÑ‚ÐµÐ¼Ð° Ð”ÐœÐ¢?",
    "ÐšÐ°Ðº ÐºÑƒÐ¿Ð¸Ñ‚ÑŒ Ð”ÐœÐ¢ Ð¸ Ð´Ñ€ÑƒÐ³Ð¸Ðµ Ñ‚Ð¾ÐºÐµÐ½Ñ‹ ÑÐºÐ¾ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹:",
  ],
  ["Ð§Ñ‚Ð¾ Ñ‚Ð°ÐºÐ¾Ðµ LP-Ñ‚Ð¾ÐºÐµÐ½Ñ‹?", "ÐšÐ°Ðº Ð¿Ð¾Ð»Ð¾Ð¶Ð¸Ñ‚ÑŒ ÑÑ€ÐµÐ´ÑÑ‚Ð²Ð° Ð² Ð¿ÑƒÐ» Ð»Ð¸ÐºÐ²Ð¸Ð´Ð½Ð¾ÑÑ‚Ð¸?"],
  ["Ð’ÐµÑ€Ð½ÑƒÑ‚ÑŒÑÑ Ð² Ð³Ð»Ð°Ð²Ð½Ð¾Ðµ Ð¼ÐµÐ½ÑŽ"],
])
  .resize()
  .oneTime();

// ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹ /start
bot.command("start", async (ctx) => {
  ctx.session = createInitialSession();
  ctx.session.mode = null;
  await ctx.reply(MESSAGES.hello, mainMenuKeyboard);
});

bot.hears("/new", async (ctx) => {
  ctx.session = createInitialSession();
  ctx.session.mode = null;
  await ctx.reply("Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð¾Ñ‡Ð¸Ñ‰ÐµÐ½Ð°", mainMenuKeyboard);
});

// ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº Ð´Ð»Ñ ÐºÐ½Ð¾Ð¿ÐºÐ¸ "FAQ", Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´ Ðº Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ°Ð¼
bot.hears("FAQ", async (ctx) => {
  ctx.session.mode = "faq";
  await ctx.reply("Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ð²Ð¾Ð¿Ñ€Ð¾Ñ:", faqMenuKeyboard);
});

// ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº Ð´Ð»Ñ ÐºÐ½Ð¾Ð¿ÐºÐ¸ "Ð§Ð°Ñ‚ Ñ Ð¢Ð°Ð¹ÑÐ¾Ð½Ð¾Ð¼", Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´ Ð² Ñ‡Ð°Ñ‚-Ñ€ÐµÐ¶Ð¸Ð¼
bot.hears("Ð§Ð°Ñ‚ Ñ Ð¢Ð°Ð¹ÑÐ¾Ð½Ð¾Ð¼", async (ctx) => {
  ctx.session.mode = "chat";
  await ctx.reply(`Ð¯ Ð½Ð°Ñ…Ð¾Ð¶ÑƒÑÑŒ Ð² Ñ€ÐµÐ¶Ð¸Ð¼Ðµ Ñ‡Ð°Ñ‚Ð°.
ÐšÐ°Ðº Ñ Ð¼Ð¾Ð³Ñƒ Ð¿Ð¾Ð¼Ð¾Ñ‡ÑŒ Ñ‚ÐµÐ±Ðµ ÑÐµÐ³Ð¾Ð´Ð½Ñ? ðŸ’¬`);
  bot.on(message("text"), processTextMessage);
});

// ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° ÐºÐ½Ð¾Ð¿ÐºÐ¸ "Ð’ÐµÑ€Ð½ÑƒÑ‚ÑŒÑÑ Ð² Ð³Ð»Ð°Ð²Ð½Ð¾Ðµ Ð¼ÐµÐ½ÑŽ"
bot.hears("Ð’ÐµÑ€Ð½ÑƒÑ‚ÑŒÑÑ Ð² Ð³Ð»Ð°Ð²Ð½Ð¾Ðµ Ð¼ÐµÐ½ÑŽ", async (ctx) => {
  await ctx.reply("Ð’Ñ‹ Ð²ÐµÑ€Ð½ÑƒÐ»Ð¸ÑÑŒ Ð² Ð³Ð»Ð°Ð²Ð½Ð¾Ðµ Ð¼ÐµÐ½ÑŽ", mainMenuKeyboard);
});

// Ð”Ð¾Ð±Ð°Ð²Ð»ÑÐµÐ¼ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸Ðº Ð½Ð°Ð¶Ð°Ñ‚Ð¸Ñ ÐºÐ½Ð¾Ð¿Ð¾Ðº FAQ
bot.hears("Ð§Ñ‚Ð¾ Ñ‚Ð°ÐºÐ¾Ðµ Ð”ÐœÐ¢ Ð¸ ÑÐºÐ¾ÑÐ¸ÑÑ‚ÐµÐ¼Ð° Ð”ÐœÐ¢?", async (ctx) => {
  const message = `
Ð”ÐœÐ¢ â€“ ÑÑ‚Ð¾ ÐºÐ¾Ð¼Ð°Ð½Ð´Ð°, Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÑŽÑ‰Ð°Ñ Ð½Ð°Ð´ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð¾Ð¼, Ð° Ñ‚Ð°ÐºÐ¶Ðµ ÐµÑ‘ Ð¾ÑÐ½Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ. ÐšÐ¾Ð¼Ð°Ð½Ð´Ð° Ð²ÐµÐ´ÐµÑ‚ ÑÐ»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ðµ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ñ‹:

- *Ð”ÐœÐ¢*
- *Ð›ÑÐ³ÑƒÑˆÐºÐ°*
- *Ð›Ð¸ÐºÐ²Ð¸Ð´Ð°Ñ‚Ð¾Ñ€*

Ð”Ñ€ÑƒÐ³Ð¸Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÑŽÑ‚ Ð½ÐµÐ·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ Ð¸ Ð½Ðµ Ð¿Ð¾Ð´Ñ‡Ð¸Ð½ÑÑŽÑ‚ÑÑ Ð”ÐœÐ¢. ÐžÐ½Ð¸ Ð²ÐºÐ»ÑŽÑ‡Ð°ÑŽÑ‚:

- *Ð¢Ð¾ÐºÐµÐ½Ñ‹-Ð¿Ð°Ñ€Ñ‚Ð½ÐµÑ€Ñ‹* â€“ Ð´Ñ€ÑƒÐ¶ÐµÑÐºÐ¸Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹, Ñ ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¼Ð¸ Ñƒ Ð½Ð°Ñ ÐµÑÑ‚ÑŒ Ð¾Ð±Ñ‰Ð¸Ðµ Ð¼ÐµÑ…Ð°Ð½Ð¸ÐºÐ¸, Ð·Ð°Ð´Ð°Ð½Ð¸Ñ Ð¸Ð»Ð¸ ÑÐ¾Ð±Ñ‹Ñ‚Ð¸Ñ.
- *Ð”Ñ€ÑƒÐ¶ÐµÑÑ‚Ð²ÐµÐ½Ð½Ñ‹Ðµ Ñ‚Ð¾ÐºÐµÐ½Ñ‹ Ð¸ ÑÐ¾Ð¾Ð±Ñ‰ÐµÑÑ‚Ð²Ð°*
- *Ð£Ñ‡Ð°ÑÑ‚Ð½Ð¸ÐºÐ¸ Ð”ÐœÐ¢ Ð»Ð¸Ð³Ð¸* â€“ [https://t.me/dmt_community_bot?start=ref_66698a601a9bf1e3fca29048](https://t.me/dmt_community_bot?start=ref_66698a601a9bf1e3fca29048)
- *Ð˜ Ð¼Ð½Ð¾Ð³Ð¾Ðµ Ð´Ñ€ÑƒÐ³Ð¾Ðµ*

Ð’ÑÐµ Ñ‚Ð¾ÐºÐµÐ½Ñ‹ Ð¸ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹ Ð²Ñ‹ÑˆÐµ â€“ Ð¾Ñ‚Ð»Ð¸Ñ‡Ð½Ñ‹Ðµ, ÑÐ°Ð¼ Ð´ÐµÑ€Ð¶Ñƒ Ð¼Ð½Ð¾Ð³Ð¾ Ð¸Ñ… Ñ‚Ð¾ÐºÐµÐ½Ð¾Ð², Ð²ÑÐµÐ³Ð´Ð° Ñ€Ð°Ð´ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶Ð°Ñ‚ÑŒ ÑÐ¾Ð²ÐµÑ‚Ð¾Ð¼ Ð¸ Ð½ÑƒÐ¶Ð½Ñ‹Ð¼ Ñ‚Ð¾Ð»Ñ‡ÐºÐ¾Ð¼, Ð½Ð¾ ÑÑ‚Ð¾ Ð¸ÑÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð´Ñ€ÑƒÐ¶ÐµÑÐºÐ¸Ðµ Ð¶ÐµÑÑ‚Ñ‹.
`;
  await ctx.reply(formatForTelegramBasicMessages(message), {
    parse_mode: "MarkdownV2",
  });
});

bot.hears("ÐšÐ°Ðº ÐºÑƒÐ¿Ð¸Ñ‚ÑŒ Ð”ÐœÐ¢ Ð¸ Ð´Ñ€ÑƒÐ³Ð¸Ðµ Ñ‚Ð¾ÐºÐµÐ½Ñ‹ ÑÐºÐ¾ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹:", async (ctx) => {
  const message = `
- Ð˜ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ *ÑÐ²Ð°Ð¿ ÐºÐ¾Ñ„Ð¸* â€“
  [https://swap.coffee/dex?referral=user_UQC8oun2zkOaRaz8Xecn-2Pl5y077tJs07yDu31aXjd0PKcI](https://swap.coffee/dex?referral=user_UQC8oun2zkOaRaz8Xecn-2Pl5y077tJs07yDu31aXjd0PKcI),
  Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¾Ð±Ð¼ÐµÐ½ÑÑ‚ÑŒ Ð¢ÐžÐ Ð¸Ð»Ð¸ Ð´Ñ€ÑƒÐ³Ð¸Ðµ Ñ‚Ð¾ÐºÐµÐ½Ñ‹ Ð½Ð° Ð½Ð°ÑˆÐ¸ Ñ‚Ð¾ÐºÐµÐ½Ñ‹ ÑÐºÐ¾ÑÐ¸ÑÑ‚ÐµÐ¼Ñ‹.
  *Ð’Ð°Ð¶Ð½Ð¾*: Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ Ð¸Ð¼ÐµÐ½Ð½Ð¾ ÑÐ²Ð°Ð¿ ÐºÐ¾Ñ„Ð¸.
  Ð•ÑÐ»Ð¸ ÐºÑƒÐ¿Ð¸Ñ‚Ðµ Ñ‡ÐµÑ€ÐµÐ· Ð´Ñ€ÑƒÐ³Ð¸Ðµ Ð¿Ð»Ð°Ñ‚Ñ„Ð¾Ñ€Ð¼Ñ‹, Ð°Ñ€Ð±Ð¸Ñ‚Ñ€Ð°Ð¶Ð½Ñ‹Ðµ Ð±Ð¾Ñ‚Ñ‹ Ð¼Ð¾Ð³ÑƒÑ‚ ÑÑŠÐµÑÑ‚ÑŒ Ñ‡Ð°ÑÑ‚ÑŒ Ñ†ÐµÐ½Ñ‹.
`;
  await ctx.reply(formatForTelegramBasicMessages(message), {
    parse_mode: "MarkdownV2",
  });
});

bot.hears("Ð§Ñ‚Ð¾ Ñ‚Ð°ÐºÐ¾Ðµ LP-Ñ‚Ð¾ÐºÐµÐ½Ñ‹?", async (ctx) => {
  const message = `
LP-Ñ‚Ð¾ÐºÐµÐ½Ñ‹ â€“ ÑÑ‚Ð¾ *Ñ‚Ð¾ÐºÐµÐ½Ñ‹ Ð¿ÑƒÐ»Ð¾Ð² Ð»Ð¸ÐºÐ²Ð¸Ð´Ð½Ð¾ÑÑ‚Ð¸*.
ÐžÐ½Ð¸ Ð²Ñ‹Ð´Ð°ÑŽÑ‚ÑÑ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑÐ¼ Ð·Ð° Ð²Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ Ð°ÐºÑ‚Ð¸Ð²Ð¾Ð² Ð² Ð¿ÑƒÐ»Ñ‹ Ð»Ð¸ÐºÐ²Ð¸Ð´Ð½Ð¾ÑÑ‚Ð¸ Ð¸ Ð¿Ñ€ÐµÐ´ÑÑ‚Ð°Ð²Ð»ÑÑŽÑ‚ ÑÐ¾Ð±Ð¾Ð¹ ÑÐ²Ð¾ÐµÐ³Ð¾ Ñ€Ð¾Ð´Ð° ÐºÐ²Ð¸Ñ‚Ð°Ð½Ñ†Ð¸ÑŽ,
Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð¹ Ð¿Ñ€Ð¾Ð²Ð°Ð¹Ð´ÐµÑ€ Ð¼Ð¾Ð¶ÐµÑ‚ Ð²ÐµÑ€Ð½ÑƒÑ‚ÑŒ Ð²Ð½ÐµÑÐµÐ½Ð½Ñ‹Ðµ ÑÑ€ÐµÐ´ÑÑ‚Ð²Ð° Ð²Ð¼ÐµÑÑ‚Ðµ Ñ Ð·Ð°Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ð½Ð½Ñ‹Ð¼Ð¸ Ð¿Ñ€Ð¾Ñ†ÐµÐ½Ñ‚Ð°Ð¼Ð¸.

LP-Ñ‚Ð¾ÐºÐµÐ½Ñ‹ Ð¼Ð¾Ð¶Ð½Ð¾ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ Ð´Ð»Ñ:

- *Ð¤Ð°Ñ€Ð¼Ð¸Ð½Ð³Ð° Ð´Ð¾Ñ…Ð¾Ð´Ð½Ð¾ÑÑ‚Ð¸* \\(Ð·Ð°Ñ€Ð°Ð±Ð¾Ñ‚Ð¾Ðº Ð¿Ñ€Ð¾Ñ†ÐµÐ½Ñ‚Ð¾Ð²\\)
- *ÐŸÐ¾Ð»ÑƒÑ‡ÐµÐ½Ð¸Ñ ÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð·Ð°Ð¹Ð¼Ð¾Ð²*
- *ÐŸÐµÑ€ÐµÐ´Ð°Ñ‡Ð¸ Ð¿Ñ€Ð°Ð²Ð° ÑÐ¾Ð±ÑÑ‚Ð²ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸ Ð½Ð° Ð»Ð¸ÐºÐ²Ð¸Ð´Ð½Ð¾ÑÑ‚ÑŒ Ð² ÑÑ‚ÐµÐ¹ÐºÐ¸Ð½Ð³Ðµ*

â—ï¸ *Ð’Ð°Ð¶Ð½Ð¾*: Ð¿Ð¾ÑÐ»Ðµ Ð¿ÐµÑ€ÐµÐ´Ð°Ñ‡Ð¸ LP-Ñ‚Ð¾ÐºÐµÐ½Ð¾Ð² Ð´Ñ€ÑƒÐ³Ð¾Ð¼Ñƒ Ð»Ð¸Ñ†Ñƒ, Ð²Ñ‹ Ð¿ÐµÑ€ÐµÑÑ‚Ð°Ð½ÐµÑ‚Ðµ Ð²Ð»Ð°Ð´ÐµÑ‚ÑŒ ÑÐ¾Ð¾Ñ‚Ð²ÐµÑ‚ÑÑ‚Ð²ÑƒÑŽÑ‰ÐµÐ¹ Ð»Ð¸ÐºÐ²Ð¸Ð´Ð½Ð¾ÑÑ‚ÑŒÑŽ.

*ÐŸÑ€Ð¾ÑÑ‚Ñ‹Ð¼Ð¸ ÑÐ»Ð¾Ð²Ð°Ð¼Ð¸, Ð»Ð¸ÐºÐ²Ð¸Ð´Ð½Ð¾ÑÑ‚ÑŒ â€“ ÑÑ‚Ð¾ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ ÑÐ²Ð¾Ð±Ð¾Ð´Ð½Ð¾ Ñ‚Ð¾Ñ€Ð³Ð¾Ð²Ð°Ñ‚ÑŒ Ð°ÐºÑ‚Ð¸Ð²Ð¾Ð¼ Ð±ÐµÐ· Ð·Ð½Ð°Ñ‡Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ñ… Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹ Ñ†ÐµÐ½Ñ‹.*
`;
  await ctx.reply(formatForTelegramBasicMessages(message), {
    parse_mode: "MarkdownV2",
  });
});

bot.hears("ÐšÐ°Ðº Ð¿Ð¾Ð»Ð¾Ð¶Ð¸Ñ‚ÑŒ ÑÑ€ÐµÐ´ÑÑ‚Ð²Ð° Ð² Ð¿ÑƒÐ» Ð»Ð¸ÐºÐ²Ð¸Ð´Ð½Ð¾ÑÑ‚Ð¸?", async (ctx) => {
  const message = `
1. ÐšÑƒÐ¿Ð¸Ñ‚Ðµ *Ñ€Ð°Ð²Ð½Ð¾Ðµ ÐºÐ¾Ð»Ð¸Ñ‡ÐµÑÑ‚Ð²Ð¾ Ð¿Ð°Ñ€Ñ‹ Ñ‚Ð¾ÐºÐµÐ½Ð¾Ð²* Ð½Ð° ÑÑƒÐ¼Ð¼Ñƒ, ÑÐºÐ²Ð¸Ð²Ð°Ð»ÐµÐ½Ñ‚Ð½ÑƒÑŽ Ð´Ð¾Ð»Ð»Ð°Ñ€Ñƒ.
2. ÐŸÐµÑ€ÐµÐ¹Ð´Ð¸Ñ‚Ðµ Ð½Ð° [DeDust](https://dedust.io/pools/) Ð¸ Ð½Ð°Ð¹Ð´Ð¸Ñ‚Ðµ Ð½ÑƒÐ¶Ð½Ñ‹Ð¹ Ð²Ð°Ð¼ Ð¿ÑƒÐ».
`;
  await ctx.reply(formatForTelegramBasicMessages(message), {
    parse_mode: "MarkdownV2",
  });
});

// ÐžÐ±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ° Ñ‚ÐµÐºÑÑ‚Ð¾Ð²Ñ‹Ñ… ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹
bot.on(message("text"), async (ctx) => {
  if (ctx.session.mode === null) {
    await ctx.reply(
      "ÐŸÐ¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð°, Ð²Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ñ€ÐµÐ¶Ð¸Ð¼, Ð½Ð°Ð¶Ð°Ð² Ð½Ð° Ð¾Ð´Ð½Ñƒ Ð¸Ð· ÐºÐ½Ð¾Ð¿Ð¾Ðº Ð² Ð¼ÐµÐ½ÑŽ."
    );
  } else if (ctx.session.mode === "faq") {
    await ctx.reply(
      "Ð§Ñ‚Ð¾Ð±Ñ‹ Ð·Ð°Ð´Ð°Ñ‚ÑŒ Ð²Ð¾Ð¿Ñ€Ð¾Ñ, Ð²ÐµÑ€Ð½Ð¸Ñ‚ÐµÑÑŒ Ð² Ñ€ÐµÐ¶Ð¸Ð¼ Ñ‡Ð°Ñ‚Ð°, Ð²Ñ‹Ð±Ñ€Ð°Ð² 'Ð§Ð°Ñ‚ Ñ Ð¢Ð°Ð¹ÑÐ¾Ð½Ð¾Ð¼' Ð² Ð³Ð»Ð°Ð²Ð½Ð¾Ð¼ Ð¼ÐµÐ½ÑŽ."
    );
  } else if (ctx.session.mode === "chat") {
    processTextMessage(ctx); // ÐŸÐµÑ€ÐµÐ´Ð°Ñ‡Ð° ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÑƒ Ð´Ð»Ñ Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ñ ChatGPT
  }
});
bot.telegram
  .setMyCommands([
    { command: "start", description: "ÐÐ°Ñ‡Ð°Ñ‚ÑŒ Ñ€Ð°Ð±Ð¾Ñ‚Ñƒ" },
    { command: "new", description: "Ð¡Ð±Ñ€Ð¾ÑÐ¸Ñ‚ÑŒ Ð¸ÑÑ‚Ð¾Ñ€Ð¸ÑŽ Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ" },
  ])
  .catch((err) => console.log("ÐžÑˆÐ¸Ð±ÐºÐ° Ð² ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ð¸ ÐºÐ¾Ð¼Ð°Ð½Ð´", err.message));

// Ð—Ð°Ð¿ÑƒÑÐº Ð±Ð¾Ñ‚Ð°
bot.launch();
process.once("SIGNIN", () => bot.stop("SIGNIN"));
process.once("SIGTERM", () => bot.stop("SIGTERM"));
